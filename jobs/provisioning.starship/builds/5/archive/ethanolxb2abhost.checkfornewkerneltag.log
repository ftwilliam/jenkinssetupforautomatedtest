+ set -e
+ '[' 0 -eq 0 ']'
+ ./checkfornewkerneldeb.sh
+ sudo wget -O /etc/apt/sources.list.d/sos_ubuntu.list http://sos-repos/scripts/sos_ubuntu.list
--2018-08-25 12:13:03--  http://sos-repos/scripts/sos_ubuntu.list
Resolving sos-repos (sos-repos)... 10.236.113.165
Connecting to sos-repos (sos-repos)|10.236.113.165|:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 75
Saving to: ‘/etc/apt/sources.list.d/sos_ubuntu.list’

     0K                                                       100% 5.31M=0s

2018-08-25 12:13:03 (5.31 MB/s) - ‘/etc/apt/sources.list.d/sos_ubuntu.list’ saved [75/75]

+ sudo apt update

WARNING: apt does not have a stable CLI interface. Use with caution in scripts.

Ign:1 http://sos-repos/repos/sos_ubuntu stable InRelease
Get:2 http://sos-repos/repos/sos_ubuntu stable Release [1,652 B]
Ign:3 http://sos-repos/repos/sos_ubuntu stable Release.gpg
Get:4 http://sos-repos/repos/sos_ubuntu stable/main amd64 Packages [2,633 B]
Get:5 http://security.ubuntu.com/ubuntu bionic-security InRelease [83.2 kB]
Hit:6 http://us.archive.ubuntu.com/ubuntu bionic InRelease
Get:7 http://us.archive.ubuntu.com/ubuntu bionic-updates InRelease [88.7 kB]
Get:8 http://us.archive.ubuntu.com/ubuntu bionic-backports InRelease [74.6 kB]
Get:9 http://us.archive.ubuntu.com/ubuntu bionic-updates/main amd64 Packages [301 kB]
Get:10 http://us.archive.ubuntu.com/ubuntu bionic-updates/main i386 Packages [271 kB]
Get:11 http://us.archive.ubuntu.com/ubuntu bionic-updates/universe i386 Packages [172 kB]
Get:12 http://us.archive.ubuntu.com/ubuntu bionic-updates/universe amd64 Packages [172 kB]
Fetched 1,166 kB in 1s (1,053 kB/s)
Reading package lists...
Building dependency tree...
Reading state information...
195 packages can be upgraded. Run 'apt list --upgradable' to see them.
++ apt-cache search linux-image
++ awk '-F - ' '{print $1}'
++ fgrep amdsos
++ sort -V
++ tail -n1
+ linuximage=linux-image-4.17.0-amdsos-build7+
+ '[' -n linux-image-4.17.0-amdsos-build7+ ']'
+ sudo apt install linux-image-4.17.0-amdsos-build7+

WARNING: apt does not have a stable CLI interface. Use with caution in scripts.

Reading package lists...
Building dependency tree...
Reading state information...
The following NEW packages will be installed:
  linux-image-4.17.0-amdsos-build7+
0 upgraded, 1 newly installed, 0 to remove and 195 not upgraded.
Need to get 53.5 MB of archives.
After this operation, 244 MB of additional disk space will be used.
Get:1 http://sos-repos/repos/sos_ubuntu stable/main amd64 linux-image-4.17.0-amdsos-build7+ amd64 4.17.0-amdsos-build7+-1 [53.5 MB]
debconf: unable to initialize frontend: Dialog
debconf: (Dialog frontend will not work on a dumb terminal, an emacs shell buffer, or without a controlling terminal.)
debconf: falling back to frontend: Readline
debconf: unable to initialize frontend: Readline
debconf: (This frontend requires a controlling tty.)
debconf: falling back to frontend: Teletype
dpkg-preconfigure: unable to re-open stdin: 
Fetched 53.5 MB in 1s (41.2 MB/s)
Selecting previously unselected package linux-image-4.17.0-amdsos-build7+.
(Reading database ... (Reading database ... 5%(Reading database ... 10%(Reading database ... 15%(Reading database ... 20%(Reading database ... 25%(Reading database ... 30%(Reading database ... 35%(Reading database ... 40%(Reading database ... 45%(Reading database ... 50%(Reading database ... 55%(Reading database ... 60%(Reading database ... 65%(Reading database ... 70%(Reading database ... 75%(Reading database ... 80%(Reading database ... 85%(Reading database ... 90%(Reading database ... 95%(Reading database ... 100%(Reading database ... 213741 files and directories currently installed.)
Preparing to unpack .../linux-image-4.17.0-amdsos-build7+_4.17.0-amdsos-build7+-1_amd64.deb ...
Unpacking linux-image-4.17.0-amdsos-build7+ (4.17.0-amdsos-build7+-1) ...
Setting up linux-image-4.17.0-amdsos-build7+ (4.17.0-amdsos-build7+-1) ...
update-initramfs: Generating /boot/initrd.img-4.17.0-amdsos-build7+
W: Possible missing firmware /lib/firmware/ast_dp501_fw.bin for module ast
Generating grub configuration file ...
Found linux image: /boot/vmlinuz-4.17.0-amdsos-build7+
Found initrd image: /boot/initrd.img-4.17.0-amdsos-build7+
Found linux image: /boot/vmlinuz-4.17.0-amdsos-build6+
Found initrd image: /boot/initrd.img-4.17.0-amdsos-build6+
Found linux image: /boot/vmlinuz-4.15.0-33-generic
Found initrd image: /boot/initrd.img-4.15.0-33-generic
Adding boot menu entry for EFI firmware configuration
done
+ sudo apt remove -y '*-jenkins'

WARNING: apt does not have a stable CLI interface. Use with caution in scripts.

Reading package lists...
Building dependency tree...
Reading state information...
Package 'python3-jenkins' is not installed, so not removed
0 upgraded, 0 newly installed, 0 to remove and 195 not upgraded.
++ echo linux-image-4.17.0-amdsos-build7+
++ grep -oP '(?<=linux-image-).+'
+ sudo grubby --set-default /boot/vmlinuz-4.17.0-amdsos-build7+
+ exit 0
